import scipy.interpolate
import numpy
import astropy.units as u
import astropy.constants as const
import IPython,sys
import matplotlib.pyplot as plt



def CoolingFunctionWiersma2009():
    """Returns T,Lambda[erg*cm**3/s]

    Can be interpolated to e.g. 10**5.5 Kelvin with numpy.interp(5.5, CoolFuncT, CoolFuncLambda)

    Digitized from Wiersma, Schaye, Smith 2009 The effect of photoionization on the cooling rates of enriched,
    astrophysical plasmas. New digitization from 01.10.2019"""

    CoolingFunctionDigitized = """
    3.3650129082264764 -24.332263242375603
    3.985962685155234 -23.205457463884432
    4.04896556814506 -23.006129614767257
    4.060359729079823 -22.899739165329056
    4.0789140077144195 -22.78625601926164
    4.097641654816325 -22.70317014446228
    4.116149701859639 -22.58158105939005
    4.134761769983338 -22.478230337078653
    4.153350722311396 -22.37082664526485
    4.172689492128562 -22.439590604249034
    4.171455582885416 -22.456525302174626
    4.16817771710973 -22.476845244237516
    4.178223245413664 -22.400643342191902
    4.178011314436787 -22.415885418048838
    4.185589024254428 -22.373552911854404
    4.18143046753039 -22.38540409208132
    4.1910521338805715 -22.33968634174958
    4.190857863818435 -22.35365824461844
    4.198453234550816 -22.310055565435924
    4.194259355997298 -22.324447091639
    4.2039516660064375 -22.273648649354946
    4.203739735029561 -22.288890725211886
    4.211388088506162 -22.241477527065136
    4.207158888123165 -22.258409399244368
    4.216709910814387 -22.21777234086494
    4.224075689655152 -22.19068191052744
    4.219917132931114 -22.20253309075436
    4.230490133888606 -22.16020341030628
    4.226331577164568 -22.1720545905332
    4.236986995724179 -22.123797436140755
    4.232746021398022 -22.14157609031204
    4.243283700526034 -22.101786755840116
    4.24959217927105 -22.078929293547425
    4.255865336186586 -22.05861217723089
    4.2611518366653325 -22.037447337006853
    4.267424993580869 -22.017130220690316
    4.273662828666926 -21.99935345034994
    4.279883002838243 -21.98284685299764
    4.286085516094821 -21.967610428633417
    4.295336303235468 -21.94856631105132
    4.304569429461376 -21.9307923664573
    4.313731912028325 -21.918099113815593
    4.343884980460548 -21.90373207741429
    4.361821405470174 -21.906289377868596
    4.379675412877679 -21.914774152267267
    4.397494098455707 -21.925799272642095
    4.415301010090574 -21.937671175008976
    4.433119695668601 -21.948696295383805
    4.450961929132948 -21.958027851774528
    4.468851258369933 -21.96397228019704
    4.486787683379559 -21.966529580651347
    4.504759430218662 -21.9665465351295
    4.522825368603045 -21.95978923367123
    4.540903080930588 -21.952185150220913
    4.559016115087609 -21.942040720794438
    4.57717624501727 -21.928509163399752
    4.595359922833251 -21.913284042020965
    4.61361424430819 -21.892978228689863
    4.6318685657831296 -21.872672415358764
    4.647092274288738 -21.85490412225746
    4.660295574148128 -21.838827509309354
    4.674509078330627 -21.821905056284653
    4.686755156611125 -21.80286376444891
    4.6989894609484635 -21.784669254605223
    4.711229652257382 -21.766051353765512
    4.72347573053788 -21.74701006192977
    4.7357571306478565 -21.725428424117876
    4.748020869843095 -21.705116959294056
    4.757253996069003 -21.687343014700037
    4.766487122294911 -21.669569070106018
    4.775702587606078 -21.653065298500074
    4.784944544289356 -21.634656267412016
    4.794168840057894 -21.617517409312036
    4.801399218552321 -21.600164971883135
    4.812688075253929 -21.57815900115976
    4.825040119022865 -21.551496671395554
    4.821850557820878 -21.565465748518054
    4.834273245248772 -21.533722726801532
    4.8434887105599405 -21.51721895519559
    4.849691223816518 -21.50198253083137
    4.858950841414536 -21.482303326755233
    4.871276393811362 -21.45754625647314
    4.88355779392134 -21.435964618661245
    4.893801124470357 -21.417344833990626
    4.908147085513404 -21.390896083555337
    4.901918080884717 -21.408037767401673
    4.920396107279693 -21.371643096221582
    4.932589202815971 -21.356412323350078
    4.94480584623857 -21.33948798649447
    4.96302484588403 -21.321722519139524
    4.98120852370001 -21.306497397760737
    4.999333331800193 -21.29550618634221
    5.017422818070894 -21.287055320899835
    5.035500530398437 -21.279451237449518
    5.053519373010181 -21.27608106395946
    5.071491119849284 -21.276098018437608
    5.08940399697259 -21.28034888287602
    5.107281552266416 -21.28714009329059
    5.125159107560242 -21.293931303705154
    5.143071984683547 -21.298182168143565
    5.160996635750012 -21.301586250589924
    5.178933060759637 -21.30414355104423
    5.196951903371381 -21.300773377554172
    5.214947198096804 -21.29909676804822
    5.232977814651708 -21.29487981256611
    5.2510084312066105 -21.290662857083998
    5.269039047761514 -21.286445901601887
    5.287093212202737 -21.28053538213567
    5.30508850692816 -21.278858772629718
    5.323095575596744 -21.27633538113171
    5.341102644265328 -21.273811989633703
    5.3651002952136135 -21.271294249628415
    5.383072042052717 -21.271311204106564
    5.401043788891822 -21.271328158584716
    5.418991987844606 -21.27303867704697
    5.436869543138433 -21.279829887461535
    5.45464113294382 -21.294242135804573
    5.466410366526347 -21.309495514646944
    5.475043021651105 -21.334907451647585
    5.48083933386867 -21.348885006009162
    5.486670967915714 -21.360322214394582
    5.4954213624720705 -21.3772663314747
    5.495303623040472 -21.38573415139522
    5.521289892988447 -21.455619097456747
    5.527050883376532 -21.47213699779448
    5.532829534679357 -21.487384725144135
    5.5386081859821825 -21.502632452493792
    5.567466120666829 -21.58141143521822
    5.573227111054914 -21.597929335555957
    5.581974562125481 -21.615085148134085
    5.593823269824336 -21.624622748530108
    5.63496849159054 -21.681396702446616
    5.652822498998047 -21.689881476845287
    5.670688280348712 -21.697519469251908
    5.688601157472018 -21.70177033369032
    5.772104317149884 -21.728099696341967
    5.789934776671071 -21.738278034724743
    5.8077299143627785 -21.750996719083677
    5.819593339490584 -21.75947584198963
    5.896952855627672 -21.79680771904524
    5.914877506694136 -21.8002118014916
    5.9329198971922 -21.79514806401744
    5.950903417974464 -21.794318236503536
    6.040809247942624 -21.79101588092608
    6.0587574468954095 -21.792726399388332
    6.076646776132394 -21.798670827810845
    6.09154670120111 -21.80418903949098
    6.17176610813171 -21.851261735201547
    6.189525923993939 -21.866520765536634
    6.207321061685645 -21.879239449895568
    6.262244151737438 -21.950421884493302
    6.270043211686482 -21.963977931689758
    6.280790467002738 -21.98092393260078
    6.289635053104373 -21.991093793744483
    6.321629566246788 -22.05971421831065
    6.330368186859985 -22.077505117382817
    6.342040285411443 -22.09974444765962
    6.3828705541981225 -22.179169819863525
    6.394569144121691 -22.19950389065821
    6.406276564502628 -22.219202874958853
    6.450225750832336 -22.28973986199257
    6.462012645329603 -22.303723067846864
    6.470751265942799 -22.321513966919035
    6.479560530214955 -22.33422417403889
    6.523606851575732 -22.397775209638176
    6.538336054468629 -22.41557176020306
    6.553065257361528 -22.43336831076795
    6.567741477510205 -22.45497538029707
    6.579563693836952 -22.46641824017521
    6.59432821855933 -22.48167444476394
    6.612123356251036 -22.49439312912287
    6.629930267885904 -22.50626503148975
    6.647748953463931 -22.51729015186458
    6.665602960871437 -22.52577492626325
    6.683480516165263 -22.532566136677815
    6.701381619345408 -22.53766378310828
    6.719282722525554 -22.542761429538743
    6.737230921478339 -22.544471948000997
    6.755190894374284 -22.545335684471198
    6.773162641213387 -22.54535263894935
    6.791146161995652 -22.544522811435446
    6.8091414567210755 -22.542846201929493
    6.827136751446499 -22.54116959242354
    6.845155594058243 -22.53779941893348
    6.863197984556306 -22.532735681459318
    6.881240375054369 -22.527671943985155
    6.8992592176661125 -22.524301770495097
    6.917266286334696 -22.52177837899709
    6.9352969028896 -22.51756142351498
    6.953303971558183 -22.515038032016975
    6.971275718397287 -22.515054986495123
    6.9893063349521904 -22.510838031013012
    7.007289855734455 -22.510008203499112
    7.025249828630399 -22.510871939969313
    7.043162705753704 -22.515122804407724
    7.0611109047064895 -22.516833322869978
    7.079035555772954 -22.520237405316337
    7.09692488500994 -22.526181833738853
    7.114778892417446 -22.534666608137524
    7.132656447711272 -22.54145781855209
    7.15048690723246 -22.551636156934865
    7.168317366753645 -22.56181449531764
    7.186147826274833 -22.571992833700417
    7.2039547379097 -22.583864736067298
    7.221785197430887 -22.594043074450074
    7.239580335122594 -22.606761758809004
    7.257410794643781 -22.61694009719178
    7.275241254164968 -22.627118435574555
    7.293083487629314 -22.63644999196528
    7.31096104292314 -22.643241202379848
    7.328850372160126 -22.649185630802364
    7.346739701397112 -22.655130059224877
    7.364640804577257 -22.66022770565534
    7.382565455643722 -22.6636317881017
    7.400513654596507 -22.665342306563954
    7.418485401435611 -22.665359261042102
    7.436421826445236 -22.667916561496412
    7.45442889511382 -22.665393169998403
    7.472400641952924 -22.665410124476555
    7.490372388792029 -22.665427078954703
    7.508391231403771 -22.662056905464645
    7.526410074015516 -22.658686731974587
    7.544428916627259 -22.65531655848453
    7.562471307125321 -22.650252821010366
    7.580525471566545 -22.64434230154415
    7.598567862064607 -22.63927856406999
    7.616610252562671 -22.634214826595827
    7.6346644170038935 -22.62830430712961
    7.652706807501956 -22.623240569655447
    7.670772745886339 -22.616483268197182
    7.688815136384402 -22.61141953072302
    7.706904622655104 -22.60296866528065
    7.724935239210008 -22.598751709798535
    7.74300117759439 -22.59199440834027
    7.761067115978773 -22.585237106882
    7.779144828306315 -22.577633023431684
    7.797198992747538 -22.571722503965468
    7.815288479018241 -22.563271638523098
    7.833342643459463 -22.557361119056882
    7.851408581843845 -22.550603817598617
    7.869486294171388 -22.542999734148296
    7.887540458612611 -22.537089214682084
    7.905641718826472 -22.527791567247657
    7.923695883267696 -22.521881047781445
    7.9417618216520784 -22.515123746323177
    7.959851307922781 -22.506672880880807
    7.977905472364003 -22.50076236141459
    7.995994958634705 -22.49231149597222
    8.014060897019089 -22.485554194513952
    8.03215038328979 -22.477103329071582
    8.050228095617332 -22.46949924562126
    8.068317581888035 -22.46104838017889
    8.086418842101896 -22.45175073274447
    8.104496554429439 -22.444146649294147
    8.122586040700142 -22.435695783851777
    8.140663753027685 -22.428091700401456
    8.158753239298386 -22.419640834959086
    8.176842725569088 -22.411189969516716
    8.19492043789663 -22.403585886066395
    8.213021698110492 -22.394288238631972
    8.231111184381195 -22.385837373189602
    8.249188896708738 -22.37823328973928
    8.267290156922598 -22.36893564230486
    8.285379643193302 -22.36048477686249
    8.303457355520845 -22.352880693412168
    8.321546841791545 -22.344429827969797
    8.339624554119087 -22.336825744519476
    8.35771404038979 -22.328374879077106
    8.375803526660492 -22.319924013634736
    8.393881238988035 -22.312319930184415
    8.411970725258737 -22.303869064742045
    8.43004843758628 -22.296264981291728
    8.448137923856981 -22.287814115849354
    8.466239184070844 -22.27851646841493
    8.484305122455226 -22.271759166956663
    8.502394608725929 -22.263308301514293
    8.52046054711031 -22.256551000056024
    8.538573581267332 -22.24640657062955
    8.556674841481195 -22.237108923195127
    8.574776101695058 -22.227811275760704
    8.5928538140226 -22.220207192310383
    8.610966848179622 -22.210062762883908
    8.629068108393483 -22.200765115449485
    8.647169368607344 -22.191467468015063
    8.665270628821208 -22.18216982058064
    8.68338366297823 -22.172025391154165
    8.70148492319209 -22.16272774371974
    8.719597957349112 -22.152583314293263
    8.737675669676655 -22.144979230842946
    8.755776929890516 -22.135681583408523
    8.77388996404754 -22.125537153982048
    8.7919912242614 -22.116239506547622
    8.810104258418423 -22.106095077121147
    8.828181970745966 -22.09849099367083
    8.840245552907486 -22.092574822711896
    """

    CoolFuncT = []
    CoolFuncLambda = []

    CoolingFunctionDigitized = CoolingFunctionDigitized.split('\n')
    for line in CoolingFunctionDigitized:
        LineSplit = line.split()

        if len(LineSplit)==2:
            CoolFuncT.append(float(LineSplit[0]))
            CoolFuncLambda.append(float(LineSplit[1]))


    CoolFuncT = numpy.array(CoolFuncT)
    CoolFuncLambda = numpy.array(CoolFuncLambda)

    return CoolFuncT,CoolFuncLambda

#From Arepo with solar metallicity

def CoolingFunctionArepoGFM():
    """Returns T,Lambda[erg*cm**3/s]

    Can be interpolated to e.g. 10**5.5 Kelvin with numpy.interp(5.5, CoolFuncT, CoolFuncLambda)

    Digitized from cells in Arepo (Martin Sparre's windtunnel simulations with solar metallicity"""

    CoolingFunctionDigitizedA = """
    3.8272499999999994 -25.046198
    3.84575 -24.730696
    3.86425 -24.465115
    3.8827499999999997 -24.195162
    3.90125 -24.050812
    3.9197499999999996 -24.024895
    3.93825 -23.89119
    3.9567499999999995 -23.674814
    3.97525 -23.491592
    3.9937499999999995 -23.333647
    4.01225 -23.200884
    4.030749999999999 -23.087324
    4.04925 -22.985489
    4.067749999999999 -22.88169
    4.08625 -22.742771
    4.104749999999999 -22.630571
    4.12325 -22.512495
    4.14175 -22.402576
    4.16025 -22.314089
    4.17875 -22.231865
    4.1972499999999995 -22.159271
    4.21575 -22.104387
    4.234249999999999 -22.047485
    4.25275 -22.017162
    4.27125 -21.982876
    4.28975 -21.948875
    4.308249999999999 -21.933958
    4.32675 -21.921095
    4.34525 -21.913074
    4.36375 -21.908228
    4.38225 -21.909433
    4.4007499999999995 -21.91062
    4.41925 -21.914303
    4.437749999999999 -21.914001
    4.45625 -21.915459
    4.47475 -21.912134
    4.49325 -21.908083
    4.511749999999999 -21.900202
    4.53025 -21.88946
    4.54875 -21.878168
    4.56725 -21.86165
    4.58575 -21.844507
    4.6042499999999995 -21.823599
    4.62275 -21.801193
    4.641249999999999 -21.776075
    4.65975 -21.750732
    4.67825 -21.722824
    4.69675 -21.694775
    4.715249999999999 -21.665585
    4.73375 -21.634115
    4.75225 -21.604658
    4.77075 -21.570547
    4.78925 -21.539734
    4.8077499999999995 -21.507298
    4.82625 -21.475924
    4.8447499999999994 -21.444431
    4.86325 -21.41607
    4.88175 -21.390154
    4.90025 -21.367361
    4.918749999999999 -21.346807
    4.93725 -21.329601
    4.95575 -21.31459
    4.97425 -21.301853
    4.99275 -21.29107
    5.0112499999999995 -21.284456
    5.02975 -21.28157
    5.0482499999999995 -21.280643
    5.06675 -21.28487
    5.08525 -21.289055
    5.10375 -21.293194
    5.122249999999999 -21.296755
    5.14075 -21.296064
    5.15925 -21.294289
    5.17775 -21.289722
    5.19625 -21.283802
    5.2147499999999996 -21.278046
    5.23325 -21.272627
    5.2517499999999995 -21.268084
    5.27025 -21.264835
    5.28875 -21.261692
    5.30725 -21.258823
    5.325749999999999 -21.25601
    5.34425 -21.253649
    5.36275 -21.251879
    5.38125 -21.256243
    5.39975 -21.262037
    5.4182500000000005 -21.280754
    5.43675 -21.30648
    5.4552499999999995 -21.342451
    5.47375 -21.390114
    5.49225 -21.440187
    5.51075 -21.491974
    5.529249999999999 -21.543602
    5.54775 -21.580061
    5.56625 -21.618519
    5.58475 -21.637924
    5.60325 -21.658667
    5.6217500000000005 -21.667831
    5.64025 -21.676353
    5.6587499999999995 -21.681192
    5.67725 -21.684969
    5.69575 -21.689367
    5.71425 -21.694315
    5.732749999999999 -21.701595
    5.75125 -21.711424
    5.76975 -21.722063
    5.78825 -21.735708
    5.80675 -21.749054
    5.8252500000000005 -21.759138
    5.84375 -21.769243
    5.8622499999999995 -21.772505
    5.88075 -21.774984
    5.89925 -21.774067
    5.91775 -21.77192
    5.936249999999999 -21.769495
    5.95475 -21.76685
    5.97325 -21.765442
    5.99175 -21.766375
    6.01025 -21.768442
    6.0287500000000005 -21.773026
    6.04725 -21.778324
    6.0657499999999995 -21.786032
    6.08425 -21.794481
    6.10275 -21.804808
    6.12125 -21.81537
    6.139749999999999 -21.828852
    6.15825 -21.842703
    6.17675 -21.859781
    6.19525 -21.880472
    6.21375 -21.903107
    6.2322500000000005 -21.93026
    6.25075 -21.960888
    6.2692499999999995 -21.993174
    6.28775 -22.029388
    6.30625 -22.065792
    6.32475 -22.102474
    6.343249999999999 -22.13485
    6.36175 -22.17067
    6.38025 -22.201866
    6.39875 -22.235128
    6.41725 -22.26391
    6.4357500000000005 -22.294123
    6.45425 -22.323143
    6.47275 -22.352207
    6.49125 -22.380058
    6.50975 -22.407904
    6.52825 -22.4365
    6.546749999999999 -22.462408
    6.56525 -22.488672
    6.58375 -22.510218
    6.60225 -22.532778
    6.62075 -22.551579
    6.6392500000000005 -22.57027
    6.65775 -22.585932
    6.67625 -22.60022
    6.69475 -22.612211
    6.71325 -22.623913
    6.73175 -22.633705
    6.750249999999999 -22.638172
    6.768750000000001 -22.64351
    6.78725 -22.649721
    6.80575 -22.655363
    6.82425 -22.65606
    6.8427500000000006 -22.655165
    6.86125 -22.653929
    6.87975 -22.653376
    6.89825 -22.652142
    6.91675 -22.650547
    6.93525 -22.648306
    6.953749999999999 -22.64566
    6.972250000000001 -22.643358
    6.99075 -22.640205
    """

    CoolFuncTA = []
    CoolFuncLambdaA = []

    CoolingFunctionDigitizedA = CoolingFunctionDigitizedA.split('\n')
    for line in CoolingFunctionDigitizedA:
        LineSplit = line.split()

        if len(LineSplit)==2:
            CoolFuncTA.append(float(LineSplit[0]))
            CoolFuncLambdaA.append(float(LineSplit[1]))

    CoolFuncTA = numpy.array(CoolFuncTA)
    CoolFuncLambdaA = numpy.array(CoolFuncLambdaA)

    return CoolFuncTA,CoolFuncLambdaA
